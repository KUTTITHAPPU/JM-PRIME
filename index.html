import streamlit as st
import pandas as pd
from datetime import datetime
import random

# --- 1. PAGE CONFIG & BRANDING ---
st.set_page_config(page_title="JM PRIME", layout="wide")

# Subtle styling to keep the original look but sharpen the "Standard" feel
st.markdown("""
    <style>
    .brand-text { font-weight: 900; letter-spacing: 2px; }
    .brand-prime { font-weight: 200; color: #007AFF; letter-spacing: 6px; }
    /* Keeping the original UI colors but making buttons cleaner */
    .stButton>button { border-radius: 8px; font-weight: bold; }
    </style>
""", unsafe_allow_html=True)

# --- 2. SIDEBAR (Original Structure) ---
with st.sidebar:
    st.markdown("<h1 class='brand-text'>JM <span class='brand-prime'>PRIME</span></h1>", unsafe_allow_html=True)
    st.markdown("---")
    
    st.header("Engine Settings")
    engine_mode = st.selectbox("Neural Model", ["Prime-v1 (Precision)", "Standard-v2 (Fast)"])
    
    st.markdown("---")
    st.subheader("System Status")
    st.success("Neural Core: ONLINE")
    st.info("Language Node: EN_IN Optimized")
    
    # New Feature: System Metrics in Sidebar
    st.metric(label="Global Sync", value="99.9%", delta="Stable")

# --- 3. MAIN TRANSLATION INTERFACE (Original Structure) ---
# We keep the col1, col2 layout exactly as it was
col1, col2 = st.columns(2)

with col1:
    st.subheader("Source Input")
    input_text = st.text_area("Enter text for analysis:", height=200, placeholder="Paste or type content here...")
    
    if st.button("EXECUTE BRIDGE", use_container_width=True):
        if input_text:
            # New Feature: Simulated Accuracy Engine
            accuracy = random.uniform(98.5, 99.9)
            st.session_state.translated_text = f"Result: [Verified Translation of {input_text}]"
            st.session_state.accuracy_score = f"{accuracy:.2f}%"
        else:
            st.warning("Input required.")

with col2:
    st.subheader("Neural Output")
    if 'translated_text' in st.session_state:
        # The output box looks the same, but now shows Accuracy
        st.success(st.session_state.translated_text)
        
        # New Feature: Accuracy Badge
        st.markdown(f"**Precision Accuracy:** :blue[{st.session_state.accuracy_score}]")
        st.caption("Verified by JM PRIME Neural Logic")
    else:
        st.info("Awaiting input data...")

# --- 4. HISTORY LOG (Original Structure) ---
st.markdown("---")
st.subheader("Session History")

if 'history' not in st.session_state:
    st.session_state.history = []

# Save Button logic from original
if 'translated_text' in st.session_state:
    if st.button("Save to Session Log"):
        st.session_state.history.append({
            "Timestamp": datetime.now().strftime("%H:%M:%S"),
            "Source": input_text[:50] + "...",
            "Accuracy": st.session_state.accuracy_score,
            "Status": "SYNCED"
        })

if st.session_state.history:
    df = pd.DataFrame(st.session_state.history)
    st.table(df)
else:
    st.write("No active logs in this session.")

st.markdown("<br><center style='opacity:0.3; font-size:10px;'>JM PRIME | NEURAL ENGINE v1.0 | 2026</center>", unsafe_allow_html=True)
